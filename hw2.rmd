---
title: "Visual Data Exploration"
author: "Bridget Viravouth & Vinny Nguyen"
date: "2025-05-01"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls()) # to rm all variables from the environment

library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyquery) # for SQL queries in R
```

```{r}
df <- read_csv("./fec_2008-2022.csv")
glimpse(df) # like head() but transposes the view
```

```{r}
political_party_df <- df %>% dplyr::select("Cand_Id", "Cand_Name", "Cand_Party_Affiliation","Cand_Office")
head(political_party_df)
```

```{r}
party_table <- query("SELECT Cand_Party_Affiliation AS Party, COUNT(*) AS Count
FROM political_party_df
WHERE Cand_Office = 'P'
GROUP BY Party
ORDER BY Count DESC
LIMIT 5")

party_table

# Create a bar plot of the top 5 political parties
ggplot(data = party_table) + geom_col(mapping = aes(x = reorder(Party, -Count), y = Count, fill = Party)) +
  labs(x = "Political Party", y = "Number of Presedential Candidates")

ggsave("./INF143WhiteRabbit/plots/president_plot.png", width = 8, height = 6, dpi = 300)
```

```{r}
library(gapminder)

 ggplot(gapminder[which($Cand_State),],  
           aes(x=reorder(country, lifeExp, function(x){x[length(x)]}),
               y=year, fill=lifeExp)) + 
               geom_tile() + 
               coord_flip() + 
           labs(x = "", y = "Yearâ€, fill = "Life Expectancy (yr)") + 
           scale_fill_viridis_c(option = "magma")
Cand_State
```