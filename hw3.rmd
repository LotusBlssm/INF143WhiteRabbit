---
title: "Spreading Misinformation"
author: "Bridget Viravouth & Vinny Nguyen"
date: "2025-05-22"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls()) # to rm all variables from the environment

library(tidyverse)
library(ggplot2)
library(dplyr)
library(tidyquery) # for SQL queries in R
library(hexbin)
```

```{r}
df <- read_csv("https://www.ics.uci.edu/~algol/teaching/s2022-IV/fec_2008-2022.csv")

glimpse(df) # like head() but transposes the view

# renaming columns bc easier, feel free to change more col names
df <- df %>%
  rename(Party = Cand_Party_Affiliation,
         Office = Cand_Office)

df$Office[df$Office == "P"] <- "President"
df$Office[df$Office == "S"] <- "Senate"
df$Office[df$Office == "H"] <- "House"
```

```{r}
q1 <- query("SELECT Party, Total_Contribution, Total_Disbursement
FROM df
WHERE Total_Disbursement > 0 AND Total_Contribution > 0")

q2 <- query("SELECT * FROM q1 WHERE Party = 'DEM' OR Party = 'REP'")

ggplot(q1, aes(x = Total_Contribution, y = Total_Disbursement)) +
  geom_hex(aes(fill = ..count..), bins = 50) + # Note: using fill instead of colour for hex bins
  coord_equal() +
  labs(title = "Total Contribution vs. Total Disbursement",
       x = "Total Contribution",
       y = "Total Disbursement") +
  scale_x_log10(labels = scales::label_number(prefix = "$",
                                            big.mark = ",",
                                            accuracy = 1)) +
  scale_y_log10(labels = scales::label_number(prefix = "$",
                                            big.mark = ",",
                                            accuracy = 1)) +
  theme(
    axis.text = element_text(size = 15),
    axis.title = element_text(size = 20),
    plot.title = element_text(size = 25, face = "bold"),
    plot.subtitle = element_text(size = 18)
  )
```